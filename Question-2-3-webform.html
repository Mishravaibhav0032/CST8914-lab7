<!DOCTYPE html>
<html lang="en">
<head>
    <title>Accessible Form with Proper Validation</title>
    <meta charset="utf-8">
    <style>
        .control, fieldset {
            margin: 10px 0;
        }

        label {
            display: inline-block;
            width: 120px;
            vertical-align: top;
        }

        input + label {
            width: auto;
        }

        .error, .required {
            color: red;
            display: block;
            font-size: 0.9em;
        }

        .error-message {
            color: red;
            font-size: 0.9em;
            display: none;
        }

        fieldset ul {
            margin: 0;
        }

        /* Accessibility Fix: Ensure focus indicators are visible */
        input:focus, button:focus, textarea:focus {
            outline: 3px solid #007BFF;
        }
    </style>
</head>
<body>

<h1>Feedback Form</h1>

<!-- Error Message Container -->
<div id="error-summary" class="error-message" role="alert" aria-live="assertive">
    <ul></ul>
</div>

<form id="feedbackForm">
    <div class="control">
        <label for="name">Full Name <span class="required">*</span></label>
        <input id="name" name="name" type="text" aria-required="true" aria-describedby="error-name"/>
        <span id="error-name" class="error-message">Please enter your full name!</span>
    </div>

    <div class="control">
        <label for="biography">Biography</label>
        <textarea id="biography" name="biography" aria-describedby="error-biography"></textarea>
        <span id="error-biography" class="error-message">Please provide details about your background.</span>
    </div>

    <fieldset>
        <legend>Gender</legend>
        <div class="control">
            <input id="gender_male" name="gender" type="radio" value="male">
            <label for="gender_male">Male</label>
        </div>
        <div class="control">
            <input id="gender_female" name="gender" type="radio" value="female">
            <label for="gender_female">Female</label>
        </div>
        <span id="error-gender" class="error-message">Please select your gender!</span>
    </fieldset>

    <div class="control">
        <input id="accept_agbs" name="accept_agbs" type="checkbox" value="1">
        <label for="accept_agbs">I accept the terms and conditions</label>
        <span id="error-accept" class="error-message">You must accept our terms and conditions!</span>
    </div>

    <div class="control">
        <input type="submit" value="Register">
    </div>
</form>

<!-- Accessible Form Validation & Error Handling -->
<script>
    document.getElementById("feedbackForm").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent form submission

        let isValid = true;
        let errorSummary = document.getElementById("error-summary");
        let errorList = errorSummary.querySelector("ul");
        errorList.innerHTML = ""; // Clear previous errors
        errorSummary.style.display = "none"; // Hide error section initially

        function showError(inputId, message) {
            isValid = false;
            let errorSpan = document.getElementById("error-" + inputId);
            errorSpan.style.display = "block";
            errorList.innerHTML += `<li><a href="#${inputId}">${message}</a></li>`;
        }

        function clearErrors() {
            document.querySelectorAll(".error-message").forEach(e => e.style.display = "none");
        }

        clearErrors();

        let name = document.getElementById("name").value.trim();
        let biography = document.getElementById("biography").value.trim();
        let gender = document.querySelector('input[name="gender"]:checked');
        let acceptTerms = document.getElementById("accept_agbs").checked;

        if (name === "") showError("name", "Please enter your full name!");
        if (biography === "") showError("biography", "Please provide details about your background.");
        if (!gender) showError("gender", "Please select your gender!");
        if (!acceptTerms) showError("accept", "You must accept our terms and conditions!");

        if (!isValid) {
            errorSummary.style.display = "block";
            errorSummary.focus();
        } else {
            alert("All inputs are valid.");
            document.getElementById("feedbackForm").submit();
        }
    });
</script>

</body>
</html>
